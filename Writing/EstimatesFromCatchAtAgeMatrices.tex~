This section describes an application of survival analysis to matrices of catch at age, developed for the purpose of estimating catchability ($q$), selectivity at age ($s(t)$) and constant natural mortality ($M$). The matrix ($C_{i,j}$) containing a sample of fishes aged to belong to a particular age-group $j$ in year $i$ contains $n+p-1$ cohorts. These cohorts were indexed by convention using $k$ ($k \in [1, n+p-1]$) and an increasing number $r_{k}$ ($ 1 \leq r_{k} \leq {\rm min}(n,p)$) identifying incrementally each age-group (see appendix p.~\pageref{Appendix:DefinitionsOfMathematicalSymbols} for more information). Each matrix $C_{i,j}$ has two cohorts with only 1 age-group representing them.\\

The derivation for a single cohort were the same as those presented in the previous section, here reproduced with indexations relative to a single cohort and accounting for selectivity

\begin{equation}
g_{k}(t; \theta) = \frac{q \ s(t) \ E(t) \times e^{-Mt-q\int_{0}^{t} s(t) \ E(t) \ dt}}{\sum_{l=1}^{r_{k}} \frac{q \ s_{k,l} \ E_{k,l}}{M+q \ s_{k,l} \ E_{k,l}} \bigl ( e^{-M \ a_{k,l}-q\int_{0}^{a_{k,l}}s(t) \ E(t) \ dt} - e^{-M \ a_{k,l}-q\int_{0}^{a_{k,l+1}}s(t) \ E(t) \ dt} \bigr )} 
\end{equation}

The likelihood function of a catch at age matrix was build using each pdf specific to each cohort ($g_{k}(t; \theta)$):

\begin{equation}
\mathcal{L} = \prod_{k=1}^{n+p-1} \prod_{l=1}^{r_{k}}  \bigl ( \int_{t=a_{k,l}}^{t=a_{k,l+1}} g_{k}(t; \theta) \ dt \bigr ) ^ {C_{k,l}}
\end{equation}

This method was implemented in R \citep{R} in the package Survival Analysis for Fisheries Research (SAFR). Numerical application of this method are available using the following commands: {\bf library(SAFR); example(llfunc3); example(llfunc4); example(llfunc5);}.\\
